<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì†” ì—ë¥´ë‹¤ ì¡°ê° & ë©”ì†Œ í†µí•© ê³„ì‚°ê¸° (ì‹œê°„ ì¶”ì •)</title>
    <style>
        body {
            font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
            background-color: #212529;
            color: #f8f9fa;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px 0;
        }
        .container {
            background-color: #343a40;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            width: 400px;
        }
        h2 { text-align: center; margin-bottom: 1.5rem; color: #ffc107; }
        
        .section-title {
            font-size: 0.85rem;
            color: #adb5bd;
            border-bottom: 1px solid #495057;
            padding-bottom: 5px;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .input-row { display: flex; gap: 10px; margin-bottom: 1rem; }
        .input-group { flex: 1; }
        
        label { display: block; margin-bottom: 0.5rem; font-weight: bold; font-size: 0.9rem;}
        input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #495057;
            border-radius: 4px;
            background-color: #495057;
            color: #fff;
            box-sizing: border-box;
        }
        
        button {
            width: 100%;
            padding: 0.75rem;
            background-color: #0d6efd;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 1.5rem;
        }
        button:hover { background-color: #0b5ed7; }
        
        .result {
            margin-top: 1.5rem;
            padding: 1rem;
            background-color: #495057;
            border-radius: 4px;
        }
        .result-block {
            margin-bottom: 1.2rem;
            border-bottom: 1px solid #6c757d;
            padding-bottom: 0.8rem;
        }
        .result-block:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        .result-header { font-size: 1rem; font-weight:bold; color: #fff; margin-bottom: 5px; }
        .sub-text { font-size: 0.85rem; color: #ced4da; margin-bottom: 4px; display: flex; justify-content: space-between;}
        .total-val { color: #ffc107; font-weight: bold; font-size: 1.1rem; text-align: right; display: block; margin-top:5px;}
        
        /* ìƒí•œ ê²½ê³  ìŠ¤íƒ€ì¼ */
        .cap-time { font-size: 1rem; color: #ff6b6b; font-weight: bold; text-align: right; margin-top: 5px; }
        
        .disclaimer {
            font-size: 0.75rem;
            color: #adb5bd;
            margin-top: 1rem;
            text-align: center;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ§© ë“œë & ë©”ì†Œ ê³„ì‚°ê¸°</h2>
    
    <div class="section-title">ìºë¦­í„° ë° ëª¬ìŠ¤í„° ì •ë³´</div>
    <div class="input-row">
        <div class="input-group">
            <label>ìºë¦­í„° ë ˆë²¨</label>
            <input type="number" id="charLevel" placeholder="ì˜ˆ: 285">
        </div>
        <div class="input-group">
            <label>ëª¬ìŠ¤í„° ë ˆë²¨</label>
            <input type="number" id="mobLevel" placeholder="ì˜ˆ: 280">
        </div>
    </div>
    
    <div class="section-title">ìŠ¤í™ ì„¤ì •</div>
    <div class="input-row">
        <div class="input-group">
            <label>ì•„íš (%)</label>
            <input type="number" id="dropRate" placeholder="ì˜ˆ: 67">
        </div>
        <div class="input-group">
            <label>ë©”íš (%)</label>
            <input type="number" id="mesoRate" placeholder="ì˜ˆ: 100">
        </div>
    </div>
    
    <div class="input-row">
        <div class="input-group">
            <label>6ë¶„ ë§ˆë¦¿ìˆ˜</label>
            <input type="number" id="mobCount" placeholder="ì˜ˆ: 1800">
        </div>
        <div class="input-group">
            <label>ì¡°ê° ì‹œì„¸(ë§Œ)</label>
            <input type="number" id="piecePrice" placeholder="ì˜ˆ: 600">
        </div>
    </div>

    <button onclick="calculate()">ê³„ì‚°í•˜ê¸°</button>

    <div class="result" id="resultBox" style="display:none;">
        
        <div class="result-block">
            <div class="result-header">ğŸ’° 1ì¬íš (2ì‹œê°„) ì´ ìˆ˜ìµ</div>
            <div class="total-val" id="totalWapRevenue">0 ë©”ì†Œ</div>
            <div class="sub-text" style="margin-top:5px;">
                <span>ìˆœìˆ˜ ë©”ì†Œ:</span> <span id="wapPureMeso">0</span>
            </div>
            <div class="sub-text">
                <span>ì¡°ê° íŒë§¤:</span> <span id="wapPieceMeso">0</span>
            </div>
            <div class="sub-text">
                <span>ì¡°ê° ê°¯ìˆ˜:</span> <span id="wapPieceCount">0ê°œ</span>
            </div>
        </div>

        <div class="result-block">
            <div class="result-header">ğŸš§ ì¼ì¼ í•„ë“œ ë©”ì†Œ ì œí•œ</div>
            <div class="sub-text">
                <span>ë‚´ ìƒí•œì„ :</span> <span id="myCap" style="color:#fff;">0</span>
            </div>
            <div class="sub-text">
                <span>ìƒí•œ ë„ë‹¬ ì†Œìš” ì‹œê°„:</span>
            </div>
            <div class="cap-time" id="timeToCap">ì•½ 0ì‹œê°„ 0ë¶„</div>
        </div>

        <div class="result-block" style="border:none;">
             <div class="sub-text">ë ˆë²¨ í˜ë„í‹° ì ìš©: <span id="penaltyDisp" style="color:#fff;">100%</span></div>
        </div>

    </div>

    <div class="disclaimer">
        * ì¡°ê° ë“œë: ì¸ë²¤ ë¡œê·¸í•¨ìˆ˜ ëª¨ë¸ ì ìš©<br>
        * ë©”ì†Œ: ê¸°ë³¸ 7.5ë°° * ë ˆë²¨ ë°˜ê° * ë©”íš% ì ìš©<br>
        * ìƒí•œ ì‹œê°„: ê¸°ë³¸ ë©”ì†Œ ëˆ„ì  ì†ë„ ê¸°ì¤€ (ë‹¨ìˆœ ì¶”ì •)
    </div>
</div>

<script>
    function formatKoreanMoney(amount) {
        if (amount <= 0) return "0 ë©”ì†Œ";
        const EOK = 100000000;
        const MAN = 10000;
        let result = "";
        
        const eokUnit = Math.floor(amount / EOK);
        const remainderEok = amount % EOK;
        
        if (eokUnit > 0) result += `${eokUnit}ì–µ `;
        
        const manUnit = Math.floor(remainderEok / MAN);
        const remainderMan = remainderEok % MAN;
        
        if (manUnit > 0) result += `${manUnit}ë§Œ `;
        if (remainderMan > 0) result += `${Math.floor(remainderMan)}`;
        
        return result.trim() + " ë©”ì†Œ";
    }

    function getLevelMultiplier(diff) {
        if (diff >= 30) return 0;
        if (diff === 29) return 0.03;
        if (diff === 28) return 0.16;
        if (diff === 27) return 0.24;
        if (diff === 26) return 0.35;
        if (diff === 25) return 0.45;
        if (diff === 24) return 0.54;
        if (diff === 23) return 0.62;
        if (diff === 22) return 0.69;
        if (diff === 21) return 0.75;
        if (diff === 20) return 0.80;
        if (diff === 19) return 0.82;
        if (diff === 18) return 0.84;
        if (diff === 17) return 0.86;
        if (diff === 16) return 0.88;
        if (diff === 15) return 0.90;
        if (diff === 14) return 0.92;
        if (diff === 13) return 0.94;
        if (diff === 12) return 0.96;
        if (diff === 11) return 0.98;
        if (diff <= 10 && diff >= -10) return 1.0;
        if (diff === -11) return 0.97;
        if (diff === -12) return 0.94;
        if (diff === -13) return 0.91;
        if (diff === -14) return 0.88;
        if (diff === -15) return 0.85;
        if (diff === -16) return 0.82;
        if (diff === -17) return 0.79;
        if (diff === -18) return 0.76;
        if (diff === -19) return 0.73;
        if (diff === -20) return 0.70;
        if (diff === -21) return 0.65;
        if (diff === -22) return 0.60;
        if (diff === -23) return 0.55;
        if (diff === -24) return 0.50;
        if (diff === -25) return 0.45;
        if (diff === -26) return 0.40;
        if (diff === -27) return 0.35;
        if (diff === -28) return 0.30;
        if (diff === -29) return 0.25;
        if (diff === -30) return 0.20;
        if (diff === -31) return 0.15;
        if (diff === -32) return 0.10;
        if (diff === -33) return 0.05;
        return 0; 
    }

    function getDailyMesoCap(level) {
        if (level < 100) return 20000000;
        if (level < 200) return 40000000;
        if (level < 260) {
            const extra = Math.floor((level - 200) / 5) * 5000000;
            return 80000000 + extra;
        } else {
            const extra = Math.floor((level - 260) / 5) * 10000000;
            return 150000000 + extra;
        }
    }

    function calculate() {
        const charLevel = parseInt(document.getElementById('charLevel').value);
        const mobLevel = parseInt(document.getElementById('mobLevel').value);
        const dropRate = parseFloat(document.getElementById('dropRate').value);
        const mesoRate = parseFloat(document.getElementById('mesoRate').value) || 0;
        const mobCount = parseFloat(document.getElementById('mobCount').value);
        const piecePriceInput = parseFloat(document.getElementById('piecePrice').value) || 0;
        const piecePrice = piecePriceInput * 10000;

        if (!charLevel || !mobLevel || !dropRate || !mobCount) {
            alert("ë¹ˆì¹¸ì„ ëª¨ë‘ ì±„ì›Œì¤˜.");
            return;
        }

        // 1. ì¡°ê°
        const BASE_PIECE_RATE = 0.000425;
        const pieceEffFactor = 1 + Math.log(1 + (dropRate / 100));
        const realPieceRate = BASE_PIECE_RATE * pieceEffFactor;
        const mobsPerWap = mobCount * 20; 
        
        const pieceCountWap = mobsPerWap * realPieceRate;
        const pieceRevenueWap = Math.floor(pieceCountWap * piecePrice);

        // 2. ë©”ì†Œ
        const diff = mobLevel - charLevel;
        const levelMult = getLevelMultiplier(diff);
        const unitBaseMeso = mobLevel * 7.5; // ëª¬ìŠ¤í„° 1ë§ˆë¦¬ë‹¹ ê¸°ë³¸ ë“œë(í‰ê· )
        const realMesoPerMob = unitBaseMeso * levelMult * (1 + (mesoRate / 100));
        const mesoRevenueWap = Math.floor(mobsPerWap * realMesoPerMob);

        // 3. ìƒí•œ ì‹œê°„ ê³„ì‚° (ìˆ˜ì •ë¨)
        const myDailyCap = getDailyMesoCap(charLevel);
        
        // ë¶„ë‹¹ íšë“ ê¸°ë³¸ ë©”ì†Œ (í˜ë„í‹°/ë©”íš ì ìš© ì „)
        const mobsPerMin = mobCount / 6; 
        const baseMesoPerMin = unitBaseMeso * mobsPerMin;

        let timeString = "ê³„ì‚° ë¶ˆê°€";
        if (baseMesoPerMin > 0) {
            const minutesToCap = myDailyCap / baseMesoPerMin;
            const hours = Math.floor(minutesToCap / 60);
            const mins = Math.floor(minutesToCap % 60);
            timeString = `ì•½ ${hours}ì‹œê°„ ${mins}ë¶„`; // 'ì•½' ì¶”ê°€
        }

        // ì¶œë ¥
        document.getElementById('totalWapRevenue').innerText = formatKoreanMoney(pieceRevenueWap + mesoRevenueWap);
        document.getElementById('wapPureMeso').innerText = formatKoreanMoney(mesoRevenueWap);
        document.getElementById('wapPieceMeso').innerText = formatKoreanMoney(pieceRevenueWap);
        document.getElementById('wapPieceCount').innerText = pieceCountWap.toFixed(2) + " ê°œ";
        
        document.getElementById('myCap').innerText = formatKoreanMoney(myDailyCap);
        document.getElementById('timeToCap').innerText = timeString;

        document.getElementById('penaltyDisp').innerText = (levelMult * 100).toFixed(0) + "% (ë°°ìœ¨ " + levelMult.toFixed(2) + ")";

        document.getElementById('resultBox').style.display = 'block';
    }
</script>

</body>
</html>